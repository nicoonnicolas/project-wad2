<!DOCTYPE html>
<html>
	<head>
		<!-- <link rel="stylesheet" href="Style/GSAPCSS.css" /> -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.6.0/gsap.min.js"></script>
		<meta name="google-signin-client_id" content="999591178620-sgthqg1ea8e8uo0qiuhstkra6ms3783a.apps.googleusercontent.com"/>
		<script type="text/javascript" src="vue.js"></script>
		<script src="https://apis.google.com/js/platform.js" async defer></script>

		<script src="https://www.gstatic.com/firebasejs/8.3.0/firebase-app.js"></script>
		<script src="https://www.gstatic.com/firebasejs/8.3.0/firebase-analytics.js"></script>
		<script src="https://www.gstatic.com/firebasejs/7.6.1/firebase-database.js"></script>
		<script src="https://www.gstatic.com/firebasejs/8.2.6/firebase-auth.js"></script>

	</head>
	<body onload="move()">
		<div id="login">
			<h1><div id="head1">Sign In</div></h1>
			<h2><div id="head2"></div></h2>
			<div
				id="signInButton"
				class="g-signin2"
				data-onsuccess="onSignIn"
			></div>
			<br />
			<!-- <div id="signOutButton">
                <a id="signOutButton" href="#" onclick="signOut();">Sign out</a>
            </div>  -->
			<script>
				var firebaseConfig = {
					apiKey: "AIzaSyDhBjd0INJO6MpP_SX3vJJFRQzgrc1yCbc",
					authDomain: "just-clover-301402.firebaseapp.com",
					databaseURL:
						"https://just-clover-301402-default-rtdb.firebaseio.com",
					projectId: "just-clover-301402",
					storageBucket: "just-clover-301402.appspot.com",
					messagingSenderId: "999591178620",
					appId: "1:999591178620:web:5ed2ca489e1fee2836b4f9",
					measurementId: "G-4M8XE224JF",
				};
				firebase.initializeApp(firebaseConfig);
				firebase.analytics();

				function onSignIn(googleUser) {
					var profile = googleUser.getBasicProfile();
					document.getElementById("head1").innerText = "Welcome! ";
					document.getElementById(
						"head2"
					).innerText = profile.getName();
					console.log("ID: " + profile.getId()); // Do not send to your backend! Use an ID token instead.
					checkUserExists(googleUser);
				}

				function move() {
					gsap.to("#head1", { duration: 1, opacity: 0.8, x: "45%" });
					gsap.to("#head2", { duration: 2, x: "42%" });
					gsap.to("#signInButton", { duration: 2, x: "45%" });
					gsap.to("#signOutButton", { duration: 2, x: "46%" });
				}

				function checkUserExists(googleUser) {
					var profile = googleUser.getBasicProfile();
					var userID = profile.getId();
					var user = firebase.database().ref("users/" + userID);
					user.once("value").then((snapshot) => {
						if (snapshot.exists()) {
							location.replace("index.html");
						} else {
							location.replace("register.html");
						}
					});
				}

				// function signOut() {
				// 	var auth2 = gapi.auth2.getAuthInstance();
				// 	auth2.signOut().then(function () {
				// 		console.log("User signed out.");
				// 	});
				// }
			</script>
		</div>
	</body>
</html>
