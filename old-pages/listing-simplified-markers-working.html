<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<script type="text/javascript" src="vue.js"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.6.0/gsap.min.js"></script>


	<!-- Load Vue followed by BootstrapVue -->
	<script src="https://unpkg.com/vue@latest/dist/vue.min.js"></script>
	<script src="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.js"></script>

	<!-- Load the following for BootstrapVueIcons support -->
	<script src="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue-icons.min.js"></script>

	<!-- Firebase Source Files-->
	<script src="https://www.gstatic.com/firebasejs/8.3.0/firebase-app.js"></script>
	<!-- <script src="https://www.gstatic.com/firebasejs/8.3.0/firebase-analytics.js"></script> -->
	<script src="https://www.gstatic.com/firebasejs/7.6.1/firebase-database.js"></script>
	<!-- <script src="https://www.gstatic.com/firebasejs/8.2.6/firebase-auth.js"></script> -->

	<!-- <script defer
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDhBjd0INJO6MpP_SX3vJJFRQzgrc1yCbc&callback=initMap">
	</script> -->

	<link rel="stylesheet" href="//unpkg.com/leaflet/dist/leaflet.css" />
	<script src="//unpkg.com/leaflet/dist/leaflet.js"></script>
	<script src="//unpkg.com/vue2-leaflet"></script>

	<script>
		// Initialize Firebase
		var firebaseConfig = {
			apiKey: "AIzaSyDhBjd0INJO6MpP_SX3vJJFRQzgrc1yCbc",
			authDomain: "just-clover-301402.firebaseapp.com",
			databaseURL:
				"https://just-clover-301402-default-rtdb.firebaseio.com",
			projectId: "just-clover-301402",
			storageBucket: "just-clover-301402.appspot.com",
			messagingSenderId: "999591178620",
			appId: "1:999591178620:web:5ed2ca489e1fee2836b4f9",
			measurementId: "G-4M8XE224JF",
		}
		firebase.initializeApp(firebaseConfig);
			// firebase.analytics();
	</script>
</head>

<body>
	<div id="app">
		<l-map :zoom="zoom" :center="center">
			<l-tile-layer :url="url" :attribution="attribution"></l-tile-layer>
			<l-marker  v-for="marker in markers" v-bind:lat-lng="marker"></l-marker>
		</l-map>
	</div>
</body>
<script>
	Vue.component("l-map", window.Vue2Leaflet.LMap);
	Vue.component("l-tile-layer", window.Vue2Leaflet.LTileLayer);
	Vue.component("l-marker", window.Vue2Leaflet.LMarker);

	new Vue({
		el: "#app",
		data() {
			return {
				zoom: 11,
				center: [1.3929672866333096, 103.89402779739353],
				url: "http://{s}.tile.osm.org/{z}/{x}/{y}.png",
				attribution:
					'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
				markers: [[44,44],[44.1,44.1]],
			};
		},
        created: function(){
            var listings = firebase.database().ref("listing/");
            allListings = "";
            listings.on("value", (snapshot) => {
                allListings = snapshot.val();
                var tempLatLongList = [];

                Object.keys(allListings).forEach(function(key) {
                    let listing = allListings[key];
                    let latLong = L.latLng(listing.lat, listing.long);
                    tempLatLongList.push(latLong);
                    // console.log(tempLatLongList);
                });
                
                this.markers = tempLatLongList;
                console.log(this.markers);
            });
        }
	});
</script>
